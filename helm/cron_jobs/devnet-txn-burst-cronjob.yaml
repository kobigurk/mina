# kubectl apply -f helm/cron_jobs/devnet-txn-burst-cronjob.yaml
# the above command, with this accompanying file, needs only be run once.  it does not get run in CI.  this file is provided here for future reference
# make sure you're in devnet2
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: devnet-txn-burst-cronjob
spec:
  concurrencyPolicy: Replace
  failedJobsHistoryLimit: 1
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - command:
            - /bin/bash
            - -c
            - "

#----
#way of doing this with the actual helper application and a private key

batch_generate_keys.exe gen-there-and-back-txns --num-accts 1 --num-txns-per-acct 10 --origin-sender-sk-path /keys/key > txn_burst.sh
chmod 777 txn_burst.sh
./txn_burst.sh


#----
#alternative way of doing this with an account unlock, no private key, no helper application

mina accounts unlock --password adsfasdfasdf B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV #can also be done via graphql
# obtained originally with 
# batch_generate_keys.exe gen-there-and-back-txns --num-accts 1 --num-txn-per-acct 10 --origin-sender-pk B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV
mina client send-payment --amount 21 --fee 2 --receiver B62qk9gGSkM5Ub76ZL3Y3MmQXQfL2GP9tYRMADy2x7fdKhBbP62ViLc --sender B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV
curl 'http://127.0.0.1:3085/graphql' -X POST -H 'content-type: application/json' --data '{\"query\":\"mutation ($sender: PublicKey!, $receiver: PublicKey!, $amount: UInt64!, $token: UInt64, $fee: UInt64!, $nonce: UInt32, $memo: String, $field: String, $scalar: String)  {\nsendPayment(input: {from: $sender, to: $receiver, amount: $amount, token: $token, fee: $fee, nonce: $nonce, memo: $memo}, signature: {field: $field, scalar: $scalar})  {\npayment  {\n__typename\nid  \n}\n\n}\n\n}\n\",\"variables\":{\"sender\":\"B62qk9gGSkM5Ub76ZL3Y3MmQXQfL2GP9tYRMADy2x7fdKhBbP62ViLc\",\"receiver\":\"B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV\",\"amount\":\"0\",\"token\":null,\"fee\":\"2000000000\",\"nonce\":null,\"memo\":null,\"field\":\"23600679310182054425301737382714455143605201128445793331287918778757709368698\",\"scalar\":\"6245010881723030005519673868803922170504856267372473466153099614450359180995\"}}'
curl 'http://127.0.0.1:3085/graphql' -X POST -H 'content-type: application/json' --data '{\"query\":\"mutation ($sender: PublicKey!, $receiver: PublicKey!, $amount: UInt64!, $token: UInt64, $fee: UInt64!, $nonce: UInt32, $memo: String, $field: String, $scalar: String)  {\nsendPayment(input: {from: $sender, to: $receiver, amount: $amount, token: $token, fee: $fee, nonce: $nonce, memo: $memo}, signature: {field: $field, scalar: $scalar})  {\npayment  {\n__typename\nid  \n}\n\n}\n\n}\n\",\"variables\":{\"sender\":\"B62qk9gGSkM5Ub76ZL3Y3MmQXQfL2GP9tYRMADy2x7fdKhBbP62ViLc\",\"receiver\":\"B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV\",\"amount\":\"0\",\"token\":null,\"fee\":\"2000000000\",\"nonce\":null,\"memo\":null,\"field\":\"23600679310182054425301737382714455143605201128445793331287918778757709368698\",\"scalar\":\"6245010881723030005519673868803922170504856267372473466153099614450359180995\"}}'
curl 'http://127.0.0.1:3085/graphql' -X POST -H 'content-type: application/json' --data '{\"query\":\"mutation ($sender: PublicKey!, $receiver: PublicKey!, $amount: UInt64!, $token: UInt64, $fee: UInt64!, $nonce: UInt32, $memo: String, $field: String, $scalar: String)  {\nsendPayment(input: {from: $sender, to: $receiver, amount: $amount, token: $token, fee: $fee, nonce: $nonce, memo: $memo}, signature: {field: $field, scalar: $scalar})  {\npayment  {\n__typename\nid  \n}\n\n}\n\n}\n\",\"variables\":{\"sender\":\"B62qk9gGSkM5Ub76ZL3Y3MmQXQfL2GP9tYRMADy2x7fdKhBbP62ViLc\",\"receiver\":\"B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV\",\"amount\":\"0\",\"token\":null,\"fee\":\"2000000000\",\"nonce\":null,\"memo\":null,\"field\":\"23600679310182054425301737382714455143605201128445793331287918778757709368698\",\"scalar\":\"6245010881723030005519673868803922170504856267372473466153099614450359180995\"}}'
curl 'http://127.0.0.1:3085/graphql' -X POST -H 'content-type: application/json' --data '{\"query\":\"mutation ($sender: PublicKey!, $receiver: PublicKey!, $amount: UInt64!, $token: UInt64, $fee: UInt64!, $nonce: UInt32, $memo: String, $field: String, $scalar: String)  {\nsendPayment(input: {from: $sender, to: $receiver, amount: $amount, token: $token, fee: $fee, nonce: $nonce, memo: $memo}, signature: {field: $field, scalar: $scalar})  {\npayment  {\n__typename\nid  \n}\n\n}\n\n}\n\",\"variables\":{\"sender\":\"B62qk9gGSkM5Ub76ZL3Y3MmQXQfL2GP9tYRMADy2x7fdKhBbP62ViLc\",\"receiver\":\"B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV\",\"amount\":\"0\",\"token\":null,\"fee\":\"2000000000\",\"nonce\":null,\"memo\":null,\"field\":\"23600679310182054425301737382714455143605201128445793331287918778757709368698\",\"scalar\":\"6245010881723030005519673868803922170504856267372473466153099614450359180995\"}}'
curl 'http://127.0.0.1:3085/graphql' -X POST -H 'content-type: application/json' --data '{\"query\":\"mutation ($sender: PublicKey!, $receiver: PublicKey!, $amount: UInt64!, $token: UInt64, $fee: UInt64!, $nonce: UInt32, $memo: String, $field: String, $scalar: String)  {\nsendPayment(input: {from: $sender, to: $receiver, amount: $amount, token: $token, fee: $fee, nonce: $nonce, memo: $memo}, signature: {field: $field, scalar: $scalar})  {\npayment  {\n__typename\nid  \n}\n\n}\n\n}\n\",\"variables\":{\"sender\":\"B62qk9gGSkM5Ub76ZL3Y3MmQXQfL2GP9tYRMADy2x7fdKhBbP62ViLc\",\"receiver\":\"B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV\",\"amount\":\"0\",\"token\":null,\"fee\":\"2000000000\",\"nonce\":null,\"memo\":null,\"field\":\"23600679310182054425301737382714455143605201128445793331287918778757709368698\",\"scalar\":\"6245010881723030005519673868803922170504856267372473466153099614450359180995\"}}'
curl 'http://127.0.0.1:3085/graphql' -X POST -H 'content-type: application/json' --data '{\"query\":\"mutation ($sender: PublicKey!, $receiver: PublicKey!, $amount: UInt64!, $token: UInt64, $fee: UInt64!, $nonce: UInt32, $memo: String, $field: String, $scalar: String)  {\nsendPayment(input: {from: $sender, to: $receiver, amount: $amount, token: $token, fee: $fee, nonce: $nonce, memo: $memo}, signature: {field: $field, scalar: $scalar})  {\npayment  {\n__typename\nid  \n}\n\n}\n\n}\n\",\"variables\":{\"sender\":\"B62qk9gGSkM5Ub76ZL3Y3MmQXQfL2GP9tYRMADy2x7fdKhBbP62ViLc\",\"receiver\":\"B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV\",\"amount\":\"0\",\"token\":null,\"fee\":\"2000000000\",\"nonce\":null,\"memo\":null,\"field\":\"23600679310182054425301737382714455143605201128445793331287918778757709368698\",\"scalar\":\"6245010881723030005519673868803922170504856267372473466153099614450359180995\"}}'
curl 'http://127.0.0.1:3085/graphql' -X POST -H 'content-type: application/json' --data '{\"query\":\"mutation ($sender: PublicKey!, $receiver: PublicKey!, $amount: UInt64!, $token: UInt64, $fee: UInt64!, $nonce: UInt32, $memo: String, $field: String, $scalar: String)  {\nsendPayment(input: {from: $sender, to: $receiver, amount: $amount, token: $token, fee: $fee, nonce: $nonce, memo: $memo}, signature: {field: $field, scalar: $scalar})  {\npayment  {\n__typename\nid  \n}\n\n}\n\n}\n\",\"variables\":{\"sender\":\"B62qk9gGSkM5Ub76ZL3Y3MmQXQfL2GP9tYRMADy2x7fdKhBbP62ViLc\",\"receiver\":\"B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV\",\"amount\":\"0\",\"token\":null,\"fee\":\"2000000000\",\"nonce\":null,\"memo\":null,\"field\":\"23600679310182054425301737382714455143605201128445793331287918778757709368698\",\"scalar\":\"6245010881723030005519673868803922170504856267372473466153099614450359180995\"}}'
curl 'http://127.0.0.1:3085/graphql' -X POST -H 'content-type: application/json' --data '{\"query\":\"mutation ($sender: PublicKey!, $receiver: PublicKey!, $amount: UInt64!, $token: UInt64, $fee: UInt64!, $nonce: UInt32, $memo: String, $field: String, $scalar: String)  {\nsendPayment(input: {from: $sender, to: $receiver, amount: $amount, token: $token, fee: $fee, nonce: $nonce, memo: $memo}, signature: {field: $field, scalar: $scalar})  {\npayment  {\n__typename\nid  \n}\n\n}\n\n}\n\",\"variables\":{\"sender\":\"B62qk9gGSkM5Ub76ZL3Y3MmQXQfL2GP9tYRMADy2x7fdKhBbP62ViLc\",\"receiver\":\"B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV\",\"amount\":\"0\",\"token\":null,\"fee\":\"2000000000\",\"nonce\":null,\"memo\":null,\"field\":\"23600679310182054425301737382714455143605201128445793331287918778757709368698\",\"scalar\":\"6245010881723030005519673868803922170504856267372473466153099614450359180995\"}}'
curl 'http://127.0.0.1:3085/graphql' -X POST -H 'content-type: application/json' --data '{\"query\":\"mutation ($sender: PublicKey!, $receiver: PublicKey!, $amount: UInt64!, $token: UInt64, $fee: UInt64!, $nonce: UInt32, $memo: String, $field: String, $scalar: String)  {\nsendPayment(input: {from: $sender, to: $receiver, amount: $amount, token: $token, fee: $fee, nonce: $nonce, memo: $memo}, signature: {field: $field, scalar: $scalar})  {\npayment  {\n__typename\nid  \n}\n\n}\n\n}\n\",\"variables\":{\"sender\":\"B62qk9gGSkM5Ub76ZL3Y3MmQXQfL2GP9tYRMADy2x7fdKhBbP62ViLc\",\"receiver\":\"B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV\",\"amount\":\"0\",\"token\":null,\"fee\":\"2000000000\",\"nonce\":null,\"memo\":null,\"field\":\"23600679310182054425301737382714455143605201128445793331287918778757709368698\",\"scalar\":\"6245010881723030005519673868803922170504856267372473466153099614450359180995\"}}'
curl 'http://127.0.0.1:3085/graphql' -X POST -H 'content-type: application/json' --data '{\"query\":\"mutation ($sender: PublicKey!, $receiver: PublicKey!, $amount: UInt64!, $token: UInt64, $fee: UInt64!, $nonce: UInt32, $memo: String, $field: String, $scalar: String)  {\nsendPayment(input: {from: $sender, to: $receiver, amount: $amount, token: $token, fee: $fee, nonce: $nonce, memo: $memo}, signature: {field: $field, scalar: $scalar})  {\npayment  {\n__typename\nid  \n}\n\n}\n\n}\n\",\"variables\":{\"sender\":\"B62qk9gGSkM5Ub76ZL3Y3MmQXQfL2GP9tYRMADy2x7fdKhBbP62ViLc\",\"receiver\":\"B62qmnkbvNpNvxJ9FkSkBy5W6VkquHbgN2MDHh1P8mRVX3FQ1eWtcxV\",\"amount\":\"0\",\"token\":null,\"fee\":\"2000000000\",\"nonce\":null,\"memo\":null,\"field\":\"23600679310182054425301737382714455143605201128445793331287918778757709368698\",\"scalar\":\"6245010881723030005519673868803922170504856267372473466153099614450359180995\"}}'
"
            
            env:
            - name: GCLOUD_KEYFILE
              value: /gcloud/keyfile.json
            image: adsfljkhasdfkljhasdfkljhasdfkljhasldkjfhzxcadsfaslkjhasdflkjdhasfkljasdhfdjsfkldjs
            imagePullPolicy: IfNotPresent
            name: devnet-txn-burst-cronjob
            resources: {}
            terminationMessagePath: /dev/termination-log
            terminationMessagePolicy: File
            volumeMounts:
            - mountPath: /keys/
              name: private-keys
          dnsPolicy: ClusterFirst
          restartPolicy: Never
          schedulerName: default-scheduler
          securityContext: {}
          terminationGracePeriodSeconds: 30
          volumes: [
            {
              "name": "private-keys",
              "secret": {
                "defaultMode": 256,
                "items": [
                  {
                    "key": "key",
                    "path": "key"
                  },
                  {
                    "key": "pub",
                    "path": "key.pub"
                  }
                ],
                "secretName": "online-whale-account-1-key"
              }
          }
          ]
  schedule: 0 0 * * *
  successfulJobsHistoryLimit: 3
  suspend: false
